# Applying CHIP-8

COSMAC VIPのマニュアルに記載されているアイデアで、CHIP-8プログラムを作成した例です。

## 1. キーが押されるのを待ち、ディスプレイに10進形式で表示します。

- CHIP-8プログラム例

```
0200 F60A V6=KEY          ;16進キーが押されるまで待ち、押されたらキーの値をV6に代入する
0202 00E0 ERASE           ;画面を消去する
0204 A300 I=0300          ;メモリポインタIを$300に設定する
0206 F633 MI=V6(3DD)      ;V6の値を10進数にしてIのアドレスに3桁にして書き込む
0208 F265 V0:V2=MI        ;Iのアドレスにある10進の値をV0,V1,V2にセットする。
020A 6400 V4=00           ;画面表示位置Xを0に設定する
020C 6500 V5=00           ;画面表示位置Yを0に設定する
020E F129 I=V1(LSDP)      ;V1の値の数字パターンのアドレスをセットする
0210 D455 SHOW 5MI@V4VS   ;2桁目の数字パターンを表示
0212 7405 V4+05           ;3桁目の表示位置を設定
0214 F229 I=V2(LSDP)      ;V2の値の数字パターンのアドレスをセットする
0216 D455 SHOW 5MI@V4V5   ;3桁目の数字パターンを表示
0218 1200 GO 0200         ;次のキー入力を待つために$0200に飛ぶ
```

- バイナリ

```
W0200 F6 0A 00 E0 A3 00 F6 33 F2 65 64 00 65 00 F1 29
W0210 D4 55 74 05 F2 29 D4 55 12 00
```

## 2. 画面に8ビットx 8ビットの正方形を表示し、キー4または6を押したままにすると、画面が左または右に移動するようにします。

- CHIP-8プログラム例

```
0200 A218 I=0218           ;メモリポインタIを$218に設定する
0202 6100 V1=10            ;画面表示位置X
0204 6200 V2=00            ;画面表示位置Y
0206 6304 V3=04            ;左に移動するキーの値
0208 6406 V4=06            ;右に移動するキーの値
020A D128 SHOW 8MI@V1V2    ;正方形をX,Yに表示
020C E39E SKIP;V3 NE KEY   ;左のキーが押されなかったらスキップ
020E 7101 V1+1             ;Xの値を1増やす
0210 E49E SKIP;V4 NE KEY   ;右のキーが押されなかったらスキップ
0212 71FF V1+FF            ;Xの値を1減らす
0214 00E0 ERASE            ;画面を消去
0216 120A GO 020A          ;正方形を再表示
0218 FF81                  ;正方形の表示データ
021A 8181
021C 8181
021E 81FF
```

- バイナリ

```
W0200 A2 18 61 00 62 00 63 04 64 06 D1 28 E3 9E 71 01
W0210 E4 9E 71 FF 00 E0 12 0A FF 81 81 81 81 81 81 FF
```

## 3. 画面に8ビットの四角を表示します。画面上をランダムに移動させます。

- CHIP-8プログラム例

```
0200 A20C I=020C           ;正方形の表示データのアドレスを設定
0202 C11F V1=RND($3F)      ;画面表示位置X
0204 C21F V2=RND($1F)      ;画面表示位置Y
0206 D128 SHOW 8MI@V1V2    ;正方形をX,Yに表示
0208 D128 SHOW 8MI@V1V2    ;正方形をX,Yで消去(XORされるから)
020A 1202 GO 0202          ;正方形を再表示
020C FF81                  ;正方形の表示データ
020E 8181
0210 8181
0212 81FF
```

- バイナリ

```
W0200 A2 0C C1 1F C2 1F D1 28 D1 28 12 02 FF 81 81 81
W0210 81 81 81 FF
```

## 4. 単一のビットを表示し、軌跡を残して画面上をランダムに移動させます。

- CHIP-8プログラム例

```
0200 A21C I=021C           ;ドットデータのアドレス
0202 6110 V1=10            ;画面表示位置X
0204 6210 V2=10            ;画面表示位置Y
0206 D121 SHOW 1MI@V1V2    ;ドットをX,Yに表示
0208 C303 V3=RND(3)        ;乱数で進む方向を決める。
020A 4300 SKIP;V3 NE 00    ;V3が0でなければ次の命令をスキップ
020C 7101 V2+FF            ;Xの値を1増やす
020E 4301 SKIP;V3 NE 01    ;V3が1でなければ次の命令をスキップ
0210 71FF V2+FF            ;Xの値を1減らす
0212 4302 SKIP;V3 NE 02    ;V3が2でなければ次の命令をスキップ
0214 7201 V2+01            ;Yの値を1増やす
0216 4303 SKIP;V3 NE 03    ;V3が3で無ければ次の命令をスキップ
0218 72FF V2+FF            ;Yの値を1減らす
021A 1206 GO 0206          ;ドットを再表示
021C 1000                  ;ドットデータ
```

- バイナリ

```
W0200 A2 1C 61 10 62 10 D1 21 C3 03 43 00 71 01 43 01
W0210 71 FF 43 02 72 01 43 03 72 FF 12 06 02 1C
```

## 5. 簡単な数字ゲームをプログラムします。

画面に100(10進数)を表示します。他のプレイヤーと交代します。各ターンでは、キー1～9を押して数字から1-9を引くことができます。000に到達した最初のプレイヤーが勝ちです。最後に押されたキーの横または縦に隣接するキーだけを押すことが許されていると、ゲームはより面白くなります。

- CHIP-8プログラム例

```
0200 6664 V6=$64             ;V6に100を入れる
0202 A300 I=0300             ;メモリポインタIを$300に設定する
0204 F633 MI=V6(3DD)         ;V6の値を10進数にしてIのアドレスに3桁にして書き込む
0206 F265 V0:V2=MI           ;Iのアドレスにある10進の値をV0,V1,V2にセットする。
0208 6400 V4=00              ;画面表示位置Xを0に設定する
020A 6500 V5=00              ;画面表示位置Yを0に設定する
020C F029 I=V0(LSDP)         ;V0の値の数字パターンのアドレスをセットする
020E D455 SHOW 5MI@V4V5      ;1桁目の数字パターンを表示
0210 7405 V4+05              ;2桁目の表示位置を設定
0212 F129 I=V1(LSDP)         ;V1の値の数字パターンのアドレスをセットする
0214 D455 SHOW 5MI@V4VS      ;2桁目の数字パターンを表示
0216 7405 V4+05              ;3桁目の表示位置を設定
0218 F229 I=V2(LSDP)         ;V2の値の数字パターンのアドレスをセットする
021A D455 SHOW 5MI@V4V5      ;3桁目の数字パターンを表示
021C F70A V7=KEY             ;16進キーが押されるまで待ち、押されたらキーの値をV7に代入する
021E 4700 SKIP;V7 NE 00      ;V7が0以外の場合は次の命令をスキップする。
0220 121C GO 021C            ;V7が0の場合は、もう一度入力待ちにする。
0222 8870 V8=V7  　　　　　　 ;V8=V7の値をコピーする（チェックのため減算するので、元のV7を壊さないようにする）
0224 690A V9=10              ;10以上の場合は入力待ちにしたいので、減算してチェックするため、V9に10を入れておく。
0226 8895 V8=V8-V9           ;V8からV9を減算する（V8が10より小さい場合はVF=0になる)
0228 3F00 SKIP;VF EQ 00      ;VFが0なら次の命令をスキップする。
022A 121C GO 021C 　　　　　　;V7が9以上の場合はもう一度入力待ちにする。
022C 8675 V6=V6-V7           ;V6からV7の値を減算する。
022E 00E0 ERASE              ;画面を消す
0230 1202 GO 0202            ;数字を再表示する
```

- バイナリ

```
W0200 66 64 A3 00 F6 33 F2 65 64 00 65 00 F0 29 D4 55
W0210 74 05 F1 29 D4 55 74 05 F2 29 D4 55 F7 0A 47 00
W0220 12 1C 88 70 69 0A 88 95 3F 00 12 1C 86 75 00 E0
W0230 12 02
```
